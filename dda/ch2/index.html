<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Global Site Tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-59055167-2"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments)};
          gtag('js', new Date());

          gtag('config', 'UA-59055167-2');
        </script>

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://notes.shichao.io/dda/ch2/">
        <link rel="shortcut icon" href="../../toki_32.png">
        

	<title>Chatper 2. Data Models and Query Languages - Shichao's Notes</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,400italic,500,600" rel="stylesheet">
        <link href="../../custom.css" rel="stylesheet">
        <link href="../../friendly.css" rel="stylesheet">
        <link href="../../theme.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Shichao's Notes</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">APUE <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li>
                            <a href="../../apue/">Contents</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch1/">Chapter 1. UNIX System Overview</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch2/">Chapter 2. UNIX Standardization and Implementations</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch3/">Chapter 3. File I/O</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch4/">Chapter 4. Files and Directories</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch5/">Chapter 5. Standard I/O Library</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch6/">Chapter 6. System Data Files and Information</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch7/">Chapter 7. Process Environment</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch8/">Chapter 8. Process Control</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch9/">Chapter 9. Process Relationships</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch10/">Chapter 10. Signals</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch11/">Chapter 11. Threads</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch12/">Chapter 12. Thread Control</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch13/">Chapter 13. Daemon Processes</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch14/">Chapter 14. Advanced I/O</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch15/">Chapter 15. Interprocess Communication</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch16/">Chapter 16. Network IPC: Sockets</a>
                        </li>
                      
                        <li>
                            <a href="../../apue/ch17/">Chapter 17. Advanced IPC</a>
                        </li>
                      
                    </ul>
                </li>
            <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">LKD <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li>
                            <a href="../../lkd/">Contents</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch1/">Chapter 1. Introduction to the Linux Kernel</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch2/">Chapter 2. Getting Started with the Kernel</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch3/">Chapter 3. Process Management</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch4/">Chapter 4. Process Scheduling</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch5/">Chapter 5. System Calls</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch6/">Chapter 6. Kernel Data Structures</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch7/">Chapter 7. Interrupts and Interrupt Handlers</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch8/">Chapter 8. Bottom Halves and Deferring Work</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch9/">Chapter 9. An Introduction to Kernel Synchronization</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch10/">Chapter 10. Kernel Synchronization Methods</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch11/">Chapter 11. Timers and Time Management</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch12/">Chapter 12. Memory Management</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch13/">Chapter 13. The Virtual Filesystem</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch14/">Chapter 14. The Block I/O Layer</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch15/">Chapter 15. The Process Address Space</a>
                        </li>
                      
                        <li>
                            <a href="../../lkd/ch16/">Chapter 16. The Page Cache and Page Writeback</a>
                        </li>
                      
                    </ul>
                </li>
            <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">UNP <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li>
                            <a href="../../unp/">Contents</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch1/">Chapter 1. Introduction</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch2/">Chapter 2. The Transport Layer: TCP, UDP, and SCTP</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch3/">Chapter 3. Sockets Introduction</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch4/">Chapter 4. Elementary TCP Sockets</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch5/">Chapter 5. TCP Client/Server Example</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch6/">Chapter 6. I/O Multiplexing: The select and poll Functions</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch7/">Chapter 7. Socket Options</a>
                        </li>
                      
                        <li>
                            <a href="../../unp/ch8/">Chapter 8. Elementary UDP Sockets</a>
                        </li>
                      
                    </ul>
                </li>
            <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">TCPv1 <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li>
                            <a href="../../tcpv1/">Contents</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch1/">Chapter 1. Introduction</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch2/">Chapter 2. The Internet Address Architecture</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch3/">Chapter 3. Link Layer</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch4/">Chapter 4. ARP: Address Resolution Protocol</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch5/">Chapter 5. The Internet Protocol (IP)</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch6/">Chapter 6. System Configuration: DHCP and Autoconfiguration</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch7/">Chapter 7. Firewalls and Network Address Translation (NAT)</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch8/">Chapter 8. ICMPv4 and ICMPv6: Internet Control Message Protocol</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch9/">Chapter 9. Broadcasting and Local Multicasting (IGMP and MLD)</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch10/">Chapter 10. User Datagram Protocol (UDP) and IP Fragmentation</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch11/">Chapter 11. Name Resolution and the Domain Name System (DNS)</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch12/">Chapter 12. TCP: The Transmission Control Protocol (Preliminaries)</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch13/">Chapter 13. TCP Connection Management</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch14/">Chapter 14. TCP Timeout and Retransmission</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch15/">Chapter 15. TCP Data Flow and Window Management</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch16/">Chapter 16. TCP Congestion Control</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch17/">Chapter 17. TCP Keepalive</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/ch18/">Chapter 18. Security: EAP, IPsec, TLS, DNSSEC, and DKIM</a>
                        </li>
                      
                        <li>
                            <a href="../../tcpv1/headers/">Headers</a>
                        </li>
                      
                    </ul>
                </li>
            <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">GOPL <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li>
                            <a href="../../gopl/">Contents</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch1/">Chapter 1. Tutorial</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch2/">Chapter 2. Program Structure</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch3/">Chapter 3. Basic Data Types</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch4/">Chapter 4. Composite Types</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch5/">Chapter 5. Functions</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch6/">Chapter 6. Methods</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch7/">Chapter 7. Interfaces</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch8/">Chapter 8. Goroutines and Channels</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch9/">Chapter 9. Concurrency with Shared Variables</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch10/">Chapter 10. Packages and the Go Tool</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch11/">Chapter 11. Testing</a>
                        </li>
                      
                        <li>
                            <a href="../../gopl/ch12/">Chapter 12. Reflection</a>
                        </li>
                      
                    </ul>
                </li>
            <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">CSN <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li>
                            <a href="../../csn/">Contents</a>
                        </li>
                      
                        <li>
                            <a href="../../csn/part1/">Part 1: Language</a>
                        </li>
                      
                        <li>
                            <a href="../../csn/part2/">Part 2: Advanced</a>
                        </li>
                      
                    </ul>
                </li>
            <li>
                    <a href="../../toc/">TOC</a>
                </li>
            </ul>
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    
                        <a href="https://github.com/shichao-an/notes/blob/master/docs/dda/ch2.md">
                    
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#chatper-2-data-models-and-query-languages">Chatper 2. Data Models and Query Languages</a></li>
        
    
        <li class="main "><a href="#relational-model-versus-document-model">Relational Model Versus Document Model</a></li>
        
            <li><a href="#the-birth-of-nosql">The Birth of NoSQL</a></li>
        
            <li><a href="#the-object-relational-mismatch">The Object-Relational Mismatch</a></li>
        
            <li><a href="#many-to-one-and-many-to-many-relationships">Many-to-One and Many-to-Many Relationships</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">
              

<h3 id="chatper-2-data-models-and-query-languages"><strong>Chatper 2. Data Models and Query Languages</strong><a class="headerlink" href="#chatper-2-data-models-and-query-languages" title="Permanent link">&para;</a></h3>
<p>Data models are perhaps the most important part of developing software, because they have such a profound effect: not only on how the software is written, but also on how we <em>think about the problem</em> that we are solving.</p>
<p>Most applications are built by layering one data model on top of another. For each layer, the key question is: how is it <em>represented</em> in terms of the next-lower layer? For example:</p>
<ol>
<li>As an application developer, you look at the real world and model it in terms of objects or data structures, and APIs that manipulate those data structures. Those structures are often specific to your application.</li>
<li>When you want to store those data structures, you express them in terms of a general-purpose data model, such as JSON or XML documents, tables in a relational database, or a graph model.</li>
<li>The engineers who built your database software decided on a way of representing that JSON/XML/relational/graph data in terms of bytes in memory, on disk, or on a network. The representation may allow the data to be queried, searched, manipulated, and processed in various ways.</li>
<li>On lower levels, hardware engineers have figured out how to represent bytes in terms of electrical currents, pulses of light, magnetic fields, and more.</li>
</ol>
<p>In a complex application there may be more intermediary levels, such as APIs built upon APIs, but the basic idea is still the same: each layer hides the complexity of the layers below it by providing a clean data model. These abstractions allow different groups (e.g. database engineers and application developers) of people to work together effectively.</p>
<p>There are many different kinds of data models, and every data model embodies assumptions about how it is going to be used. [p28]</p>
<p>It can take a lot of effort to master just one data model. Building software is hard enough, even when working with just one data model and without worrying about its inner workings. But since the data model has such a profound effect on what the software above it can and can't do, it's important to choose one that is appropriate to the application.</p>
<p>This chapter covers a range of general-purpose data models for data storage and querying (point 2 in the preceding list), in particular, comparing the relational model, the document model, and a few graph-based data models. We will also look at various query languages and compare their use cases. In <a href="ch3.md">Chapter 3</a> we will discuss how storage engines work; that is, how these data models are actually implemented (point 3 in the list).</p>
<h3 id="relational-model-versus-document-model">Relational Model Versus Document Model<a class="headerlink" href="#relational-model-versus-document-model" title="Permanent link">&para;</a></h3>
<p>The best-known data model today is probably that of SQL, based on the <a href="https://en.wikipedia.org/wiki/Relational_model">relational model</a> proposed by <a href="https://en.wikipedia.org/wiki/Edgar_F._Codd">Edgar Codd</a> in 1970: data is organized into <em>relations</em> (called <em>tables</em> in SQL), where each relation is an unordered collection of <em>tuples</em> (<em>rows</em> in SQL).</p>
<p>The relational model was a theoretical proposal, and many people at the time doubted whether it could be implemented efficiently. However, by the mid-1980s, <a href="https://en.wikipedia.org/wiki/Relational_database_management_system">relational database management systems</a> (RDBMSes) and SQL had become the tools of choice for most people who needed to store and query data with some kind of regular structure. The dominance of relational databases has lasted around 25‒30 years, an eternity in computing history.</p>
<p>The roots of relational databases lie in <em>business data processing</em>, which was performed on mainframe computers in the 1960s and 1970s. The use cases appear mundane from today's perspective:</p>
<ul>
<li>Transaction processing: entering sales or banking transactions, airline reservations, stock-keeping in warehouse.</li>
<li>Batch processing: customer invoicing, payroll, reporting.</li>
</ul>
<p>Other databases at that time forced application developers to think a lot about the internal representation of the data in the database. The goal of the relational model was to hide that implementation detail behind a cleaner interface.</p>
<p>Over the years, there have been many competing approaches to data storage and querying:</p>
<ul>
<li>The network model and the hierarchical model were the main alternatives in the 1970s and early 1980s, but the relational model came to dominate them.</li>
<li>Object databases came and went again in the late 1980s and early 1990s.</li>
<li>XML databases appeared in the early 2000s, but have only seen niche adoption.</li>
</ul>
<p>Each competitor to the relational model generated a lot of hype in its time, but it never lasted.</p>
<p>As computers became vastly more powerful and networked, they started being used for increasingly diverse purposes. Relational databases turned out to generalize very well, beyond their original scope of business data processing, to a broad variety of use cases. Much of what you see on the web today is still powered by relational databases, be it online publishing, discussion, social networking, ecommerce, games, software-as-a-service productivity applications, etc.</p>
<h4 id="the-birth-of-nosql">The Birth of NoSQL<a class="headerlink" href="#the-birth-of-nosql" title="Permanent link">&para;</a></h4>
<p>Now, in the 2010s, NoSQL is the latest attempt to overthrow the relational model's dominance. The name "NoSQL" is unfortunate, since it doesn't actually refer to any particular technology. [p29] A number of interesting database systems are now associated with the NoSQL, and it has been retroactively reinterpreted as <em>Not Only SQL</em>.</p>
<p>There are several driving forces behind the adoption of NoSQL databases:</p>
<ul>
<li>A need for greater scalability than relational databases can easily achieve, including very large datasets or very high write throughput</li>
<li>A widespread preference for free and open source software over commercial database products</li>
<li>Specialized query operations that are not well supported by the relational model</li>
<li>Frustration with the restrictiveness of relational schemas, and a desire for a more dynamic and expressive data model</li>
</ul>
<p>Different applications have different requirements. It therefore seems likely that in the foreseeable future, relational databases will continue to be used alongside a broad variety of nonrelational datastores—an idea that is sometimes called <a href="https://en.wikipedia.org/wiki/Polyglot_persistence"><em>polyglot persistence</em></a>.</p>
<h4 id="the-object-relational-mismatch">The Object-Relational Mismatch<a class="headerlink" href="#the-object-relational-mismatch" title="Permanent link">&para;</a></h4>
<p>Most application development today is done in object-oriented programming languages, which leads to a common criticism of the SQL data model: if data is stored in relational tables, an awkward translation layer is required between the objects in the application code and the database model of tables, rows, and columns. The disconnect between the models is sometimes called an <a href="https://en.wikipedia.org/wiki/Object-relational_impedance_mismatch"><em>impedance mismatch</em></a>.</p>
<p><a href="https://en.wikipedia.org/wiki/Object-relational_mapping">Object-relational mapping</a> (ORM) frameworks like ActiveRecord and Hibernate reduce the amount of boilerplate code required for this translation layer, but they can't completely hide the differences between the two models.</p>
<p>For example, the following figure illustrates how a LinkedIn profile could be
expressed in a relational schema.</p>
<p><a href="../figure_2-1.png" title="Figure 2-1. Representing a LinkedIn profile using a relational schema."><img alt="Figure 2-1. Representing a LinkedIn profile using a relational schema. " src="../figure_2-1_600.png" /></a></p>
<p>The profile as a whole can be identified by a unique identifier, <code>user_id</code>. Fields like <code>first_name</code> and <code>last_name</code> appear exactly once per user, so they can be modeled as columns on the <code>users</code> table. However, most people have had more than one job in their career (positions), and people may have varying numbers of periods of education and any number of pieces of contact information.  There is a one-to-many relationship from the user to these items, which can be represented in various ways:</p>
<ul>
<li>In the traditional SQL model (prior to <a href="https://en.wikipedia.org/wiki/SQL:1999">SQL:1999</a>), the most common normalized representation is to put positions, education, and contact information in separate tables, with a foreign key reference to the users table, as in <a href="../figure_2-1.png">Figure 2-1</a>.</li>
<li>Later versions of the SQL standard added support for structured datatypes and XML data; this allowed multi-valued data to be stored within a single row, with support for querying and indexing inside those documents. These features are supported to varying degrees by Oracle, IBM DB2, MS SQL Server, and PostgreSQL. A JSON datatype is also supported by several databases, including IBM DB2, MySQL, and PostgreSQL.</li>
<li>A third option is to encode jobs, education, and contact info as a JSON or XML document, store it on a text column in the database, and let the application interpret its structure and content. In this setup, you typically cannot use the database to query for values inside that encoded column.</li>
</ul>
<p>For a data structure like a résumé, which is mostly a self-contained document, a JSON representation can be quite appropriate: see the following example 2-1. JSON has the appeal of being much simpler than XML. Document-oriented databases like MongoDB, RethinkDB, CouchDB, and Espresso support this data model.</p>
<p><small>Example 2-1. Representing a LinkedIn profile as a JSON document</small></p>
<div class="codehilite"><pre>  <span class="s2">&quot;user_id&quot;</span><span class="err">:</span> <span class="mi">251</span><span class="err">,</span>
  <span class="s2">&quot;first_name&quot;</span><span class="err">:</span> <span class="s2">&quot;Bill&quot;</span><span class="err">,</span>
  <span class="s2">&quot;last_name&quot;</span><span class="err">:</span> <span class="s2">&quot;Gates&quot;</span><span class="err">,</span>
  <span class="s2">&quot;summary&quot;</span><span class="err">:</span> <span class="s2">&quot;Co-chair of the Bill &amp; Melinda Gates... Active blogger.&quot;</span><span class="err">,</span>
  <span class="s2">&quot;region_id&quot;</span><span class="err">:</span> <span class="s2">&quot;us:91&quot;</span><span class="err">,</span>
  <span class="s2">&quot;industry_id&quot;</span><span class="err">:</span> <span class="mi">131</span><span class="err">,</span>
  <span class="s2">&quot;photo_url&quot;</span><span class="err">:</span> <span class="s2">&quot;/p/7/000/253/05b/308dd6e.jpg&quot;</span><span class="err">,</span>
  <span class="s2">&quot;positions&quot;</span><span class="err">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;job_title&quot;</span><span class="p">:</span> <span class="s2">&quot;Co-chair&quot;</span><span class="p">,</span>
      <span class="nt">&quot;organization&quot;</span><span class="p">:</span> <span class="s2">&quot;Bill &amp; Melinda Gates Foundation&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;job_title&quot;</span><span class="p">:</span> <span class="s2">&quot;Co-founder, Chairman&quot;</span><span class="p">,</span>
      <span class="nt">&quot;organization&quot;</span><span class="p">:</span> <span class="s2">&quot;Microsoft&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span><span class="err">,</span>
  <span class="s2">&quot;education&quot;</span><span class="err">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;school_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Harvard University&quot;</span><span class="p">,</span>
      <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="mi">1973</span><span class="p">,</span>
      <span class="nt">&quot;end&quot;</span><span class="p">:</span> <span class="mi">1975</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;school_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Lakeside School, Seattle&quot;</span><span class="p">,</span>
      <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="nt">&quot;end&quot;</span><span class="p">:</span> <span class="kc">null</span>
    <span class="p">}</span>
  <span class="p">]</span><span class="err">,</span>
  <span class="s2">&quot;contact_info&quot;</span><span class="err">:</span> <span class="p">{</span>
    <span class="nt">&quot;blog&quot;</span><span class="p">:</span> <span class="s2">&quot;http://thegatesnotes.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;twitter&quot;</span><span class="p">:</span> <span class="s2">&quot;http://twitter.com/BillGates&quot;</span>
  <span class="p">}</span>
<span class="err">}</span>
</pre></div>


<p>Some think that the JSON model reduces the impedance mismatch between the application code and the storage layer. However, as we shall see in <a href="ch4.md">Chapter 4</a>, there are also problems with JSON as a data encoding format. The lack of a schema is often cited as an advantage, which will be discussed this in <a href="#schema-flexibility-in-the-document-model">Schema flexibility in the docu‐ ment model</a>.</p>
<p>The JSON representation has better <em>locality</em> than the multi-table schema in <a href="../figure_2-1.png">Figure 2-1</a>. If you want to fetch a profile in the relational example, you need to either perform multiple queries (query each table by <code>user_id</code>) or perform a messy multi-way join between the users table and its subordinate tables. In the JSON representation, all the relevant information is in one place, and one query is sufficient.</p>
<p>The one-to-many relationships from the user profile to the user's positions, educational history, and contact information imply a tree structure in the data, and the JSON representation makes this tree structure explicit (see <a href="../figure_2-2.png">Figure 2-2</a> below).</p>
<p><a href="../figure_2-2.png" title="Figure 2-2. One-to-many relationships forming a tree structure."><img alt="Figure 2-2. One-to-many relationships forming a tree structure." src="../figure_2-2_600.png" /></a></p>
<h4 id="many-to-one-and-many-to-many-relationships">Many-to-One and Many-to-Many Relationships<a class="headerlink" href="#many-to-one-and-many-to-many-relationships" title="Permanent link">&para;</a></h4>
<p>In the previous example, <code>region_id</code> and <code>industry_id</code> are given as IDs, not as plain-text strings "<code>Greater Seattle Area</code>" and "<code>Philanthropy</code>". Why?</p>
<p>If the user interface has free-text fields for entering the region and the industry, it makes sense to store them as plain-text strings. But there are advantages to having standardized lists of geographic regions and industries, and letting users choose from a drop-down list or autocompleter:</p>
<ul>
<li>Consistent style and spelling across profiles</li>
<li>Avoiding ambiguity (e.g., if there are several cities with the same name)</li>
<li>Ease of updating. The name is stored in only one place, so it is easy to update across the board if it ever needs to be changed (e.g., change of a city name due to political events)</li>
<li>Localization support. When the site is translated into other languages, the stand‐ ardized lists can be localized, so the region and industry can be displayed in the viewer's language</li>
<li>Better search. For example, a search for philanthropists in the state of Washington can match this profile, because the list of regions can encode the fact that Seattle is in Washington (which is not apparent from the string "<code>Greater Seattle Area</code>")</li>
</ul>
<p>Whether you store an ID or a text string is a question of duplication:</p>
<ul>
<li>When you use an ID, the information that is meaningful to humans (such as the word <em>Philanthropy</em>) is stored in only one place, and everything that refers to it uses an ID (which only has meaning within the database).</li>
<li>When you store the text directly, you are duplicating the human-meaningful information in every record that uses it.</li>
</ul>
<p><u>The advantage of using an ID is that because it has no meaning to humans, it never needs to change: the ID can remain the same, even if the information it identifies changes.</u> Anything that is meaningful to humans may need to change sometime in the future. If that information is duplicated, all the redundant copies need to be updated. That incurs write overheads, and risks inconsistencies (where some copies of the information are updated but others aren't). Removing such duplication is the key idea behind <em>normalization</em> in databases.</p>
            </div>
        </div>

        <footer class="col-md-12">
            
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../custom.js"></script>
    </body>
</html>